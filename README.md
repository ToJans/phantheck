Requires closed type families which are present in at least GHC 7.7.20140103
